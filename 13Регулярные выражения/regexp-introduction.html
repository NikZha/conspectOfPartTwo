<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Введение: шаблоны и флаги</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script defer src="../scripts.js"></script>
</head>

<body>
    <div class="contents">
        <h2><a href="#intro">Введение: шаблоны и флаги</a></h2>
        <ul>
            <li><a href="#reg">Регулярные выражения</a></li>
            <li><a href="#flags">Флаги</a></li>
            <li><a href="#match">Поиск: str.match</a></li>
            <li><a href="#replace">Замена: str.replace</a></li>
            <li><a href="#test">Проверка: regexp.test</a></li>
            <li><a href="#total">Итого</a></li>
        </ul>
    </div>
    <div class="topic" id="intro">
        <h2><a href="https://learn.javascript.ru/regexp-introduction">Введение: шаблоны и флаги</a></h2>
        <p>В JavaScript регулярные выражения реализованы отдельным объектом RegExp и интегрированы в методы строк.</p>
    </div>
    <div class="topic" id="reg">
        <h3>Регулярные выражения</h3>
        <p>Регулярка состоит из шаблона (паттерна) и необязательных флагов. Существует пара способов создания регулярки:
        </p>
        <pre><code class="language-js">
//1 Способ:
regexp = new RegExp("шаблон", "флаги");
//2 способ:
regexp = /шаблон/; // без флагов
regexp = /шаблон/gmi; // с флагами gmi (будут описаны далее)            
        </code></pre>
        <p>Так же регулярное выражение можно создать на лету:</p>
        <pre><code class="language-js">
let tag = prompt("Какой тег вы хотите найти?", "h2");

let regexp = new RegExp(`&lt;${tag}>`); // то же, что /&lt;h2>/  при ответе "h2" на prompt выше            
        </code></pre>
        <p>Между <code>/.../</code> нельзя воткнуть переменную, а при создании при помощи <code>new RegExp(...)</code>
            можно.</p>
    </div>
    <div class="topic" id="flags">
        <h3>Флаги</h3>
        <p>В JavaScript их всего семь:</p>
        <ol>
            <li><code>i</code>
                <br>С этим флагом поиск не зависит от регистра: нет разницы между A и a (см. пример ниже).
            </li>
            <li><code>g</code>
                <br>С этим флагом поиск ищет все совпадения, без него – только первое.
            </li>
            <li><code>m</code>
                <br>Многострочный режим (рассматривается в главе Многострочный режим якорей ^ $, флаг "m").
            </li>
            <li><code>s</code>
                <br>Включает режим «dotall», при котором точка . может соответствовать символу перевода строки \n
                (рассматривается в главе Символьные классы).
            </li>
            <li><code>u</code>
                <br>Включает полную поддержку Юникода. Флаг разрешает корректную обработку суррогатных пар (подробнее об
                этом в главе Юникод: флаг "u" и класс \p{...}).
            </li>
            <li><code>y</code>
                <br>Режим поиска на конкретной позиции в тексте (описан в главе Поиск на заданной позиции, флаг "y").
            </li>
            <li><code>d</code>
                <br>С этим флагом результат регулярного выражения помещается в массив, который содержит дополнительную
                информацию о регулярном выражении, например индексы начала и конца подстрок. Этот флаг не меняет
                поведение регулярного выражения, а лишь предоставляет дополнительную информацию.
            </li>
        </ol>
    </div>
    <div class="topic" id="match">
        <h3>Поиск: str.match</h3>
        <p>Метод <code>str.match(regexp)</code> для строки str возвращает совпадения с регулярным выражением
            <code>regexp</code>.

            У него есть три режима работы:
        </p>
        <ol>
            <li>Если у регулярного выражения есть флаг <code>g</code>, то он возвращает массив всех совпадений:
                <pre><code class="language-js">
let str = "Любо, братцы, любо!";
alert( str.match(/любо/gi) ); // Любо,любо (массив из 2х подстрок-совпадений)    
</code></pre>
            </li>
            <li>Если такого флага нет, то возвращает только первое совпадение в виде массива, в котором по индексу 0
                находится совпадение, и есть свойства с дополнительной информацией о нём:
                <pre><code class="language-js">
let str = "Любо, братцы, любо!";

let result = str.match(/любо/i); // без флага g

alert( result[0] );     // Любо (первое совпадение)
alert( result.length ); // 1

// Дополнительная информация:
alert( result.index );  // 0 (позиция совпадения)
alert( result.input );  // Любо, братцы, любо! (исходная строка)                
            </code></pre>
            </li>
            <li>И, наконец, если совпадений нет, то, вне зависимости от наличия флага <code>g</code>, возвращается
                <code>null</code>.
                <pre><code class="language-js">
let matches = "JavaScript".match(/HTML/); // = null

if (!matches.length) { // Ошибка: у null нет свойства length
  alert("Ошибка в строке выше");
}    
</code></pre>
                <p>Соотвественно или надо проверять на нуль или:</p>
                <pre><code class="language-js">
let matches = "JavaScript".match(/HTML/) || [];

if (!matches.length) {
  alert("Совпадений нет"); // теперь работает
}    
</code></pre>
            </li>
        </ol>
    </div>
    <div class="topic" id="replace">
        <h3>Замена: str.replace</h3>
        <p>Метод <code>str.replace(regexp, replacement)</code> заменяет совпадения с <code>regexp</code> в строке
            <code>str</code> на <code>replacement</code> (все, если есть флаг <code>g</code>, иначе только первое).
        </p>
        <pre><input type="button" value="Тест replace" onclick="expl1()"><code class="language-js">
// без флага g
alert( "We will, we will".replace(/we/i, "I") ); // I will, we will

// с флагом g
alert( "We will, we will".replace(/we/ig, "I") ); // I will, I will                
            </code></pre>
        <script>
            function expl1() {
                // без флага g
                alert("We will, we will".replace(/we/i, "I")); // I will, we will

                // с флагом g
                alert("We will, we will".replace(/we/ig, "I")); // I will, I will                    
            }
        </script>
        <p>В строке замены <code>replacement</code> мы можем использовать специальные комбинации символов для вставки
            фрагментов совпадения:</p>
        <table>
            <thead>
                <tr>
                    <th>Спецсимволы</th>
                    <th>Действие в строке замены</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>$&</code></td>
                    <td> вставляет всё найденное совпадение</td>
                </tr>
                <tr>
                    <td><code>$`</code></td>
                    <td>вставляет часть строки до совпадения</td>
                </tr>
                <tr>
                    <td>$'</td>
                    <td>вставляет часть строки после совпадения</td>
                </tr>
                <tr>
                    <td><code>$n</code></td>
                    <td> если n это 1-2 значное число, вставляет содержимое n-й скобочной группы регулярного выражения,
                        больше об этом в главе Скобочные группы</td>
                </tr>
                <tr>
                    <td><code>$&lt;name></code></td>
                    <td>вставляет содержимое скобочной группы с именем name, также изучим в главе Скобочные группы</td>
                </tr>
                <tr>
                    <td><code>$$</code></td>
                    <td>вставляет символ "$"</td>
                </tr>
            </tbody>
        </table>
        <p>Пример с <code>$&</code>:</p>
        <pre class="startbutton" onclick="expl2()"><code class="language-js">
alert( "Люблю HTML".replace(/HTML/, "$& и JavaScript") ); // Люблю HTML и JavaScript
            </code></pre>
        <script>
            function expl2() {
                alert("Люблю HTML".replace(/HTML/, "$& и JavaScript")); // Люблю HTML и JavaScript                    
            }
        </script>
    </div>








</body>

</html>